# æ¶ˆæ¯é˜Ÿåˆ—

## ğŸ¯ æ ¸å¿ƒçŸ¥è¯†ç‚¹

- æ¶ˆæ¯é˜Ÿåˆ—åŸºæœ¬æ¦‚å¿µ
- MQäº§å“å¯¹æ¯”åˆ†æ
- æ¶ˆæ¯å¯é æ€§ä¿è¯
- æ¶ˆæ¯é¡ºåºæ€§å¤„ç†
- é«˜å¯ç”¨æ¶æ„è®¾è®¡

## ğŸ“Š æ¶ˆæ¯é˜Ÿåˆ—æ ¸å¿ƒæ¶æ„

```mermaid
graph TB
    A[æ¶ˆæ¯ç”Ÿäº§è€…] --> B[æ¶ˆæ¯é˜Ÿåˆ—]
    B --> C[æ¶ˆæ¯æ¶ˆè´¹è€…]
    
    subgraph "æ¶ˆæ¯é˜Ÿåˆ—ç»„ä»¶"
        B --> D[Brokerä»£ç†]
        B --> E[Topicä¸»é¢˜]
        B --> F[Partitionåˆ†åŒº]
        B --> G[Consumer Group]
    end
    
    subgraph "å¯é æ€§ä¿è¯"
        H[æ¶ˆæ¯æŒä¹…åŒ–]
        I[æ¶ˆæ¯ç¡®è®¤æœºåˆ¶]
        J[é‡è¯•æœºåˆ¶]
        K[æ­»ä¿¡é˜Ÿåˆ—]
    end
    
    D --> H
    D --> I
    D --> J
    D --> K
```

## ğŸ’¡ é¢è¯•é¢˜ç›®

### **åˆçº§** æ¶ˆæ¯é˜Ÿåˆ—åŸºæœ¬åŸç†
**é¢˜ç›®ï¼š** è§£é‡Šæ¶ˆæ¯é˜Ÿåˆ—çš„ä½œç”¨å’Œæ ¸å¿ƒæ¦‚å¿µï¼Œå¯¹æ¯”åŒæ­¥è°ƒç”¨å’Œå¼‚æ­¥æ¶ˆæ¯çš„åŒºåˆ«ã€‚

**ç­”æ¡ˆè¦ç‚¹ï¼š**

```mermaid
graph LR
    A[æ¶ˆæ¯é˜Ÿåˆ—ä½œç”¨] --> B[è§£è€¦]
    A --> C[å¼‚æ­¥]
    A --> D[å‰Šå³°]
    A --> E[å®¹é”™]
    
    B --> B1[é™ä½ç³»ç»Ÿé—´ä¾èµ–]
    C --> C1[æé«˜å“åº”é€Ÿåº¦]
    D --> D1[å¤„ç†æµé‡çªå¢]
    E --> E1[æé«˜ç³»ç»Ÿå¯ç”¨æ€§]
```

**åŒæ­¥ vs å¼‚æ­¥å¯¹æ¯”ï¼š**

| ç‰¹æ€§ | åŒæ­¥è°ƒç”¨ | å¼‚æ­¥æ¶ˆæ¯ |
|------|----------|----------|
| å“åº”æ—¶é—´ | éœ€ç­‰å¾…å¤„ç†å®Œæˆ | ç«‹å³è¿”å› |
| è€¦åˆåº¦ | å¼ºè€¦åˆ | æ¾è€¦åˆ |
| å¯é æ€§ | è°ƒç”¨å¤±è´¥ç«‹å³æ„ŸçŸ¥ | éœ€è¦é¢å¤–æœºåˆ¶ä¿è¯ |
| æ‰©å±•æ€§ | å—é™äºæœ€æ…¢æœåŠ¡ | ç‹¬ç«‹æ‰©å±• |
| å¤æ‚åº¦ | ç›¸å¯¹ç®€å• | éœ€è¦è€ƒè™‘æ¶ˆæ¯ä¸¢å¤±ç­‰é—®é¢˜ |

### **ä¸­çº§** æ¶ˆæ¯å¯é æ€§è®¾è®¡
**é¢˜ç›®ï¼š** å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ä¼ é€’ï¼ŸåŒ…æ‹¬æ¶ˆæ¯ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€æœ‰åºå¤„ç†ã€‚

**ç­”æ¡ˆè¦ç‚¹ï¼š**

```mermaid
graph TD
    A[æ¶ˆæ¯å¯é æ€§] --> B[ç”Ÿäº§è€…å¯é æ€§]
    A --> C[Brokerå¯é æ€§]
    A --> D[æ¶ˆè´¹è€…å¯é æ€§]
    
    B --> B1[å‘é€ç¡®è®¤]
    B --> B2[é‡è¯•æœºåˆ¶]
    B --> B3[å¹‚ç­‰å‘é€]
    
    C --> C1[æ¶ˆæ¯æŒä¹…åŒ–]
    C --> C2[é›†ç¾¤éƒ¨ç½²]
    C --> C3[å‰¯æœ¬åŒæ­¥]
    
    D --> D1[æ¶ˆè´¹ç¡®è®¤]
    D --> D2[å¹‚ç­‰æ¶ˆè´¹]
    D --> D3[å¼‚å¸¸å¤„ç†]
```

**æ¶ˆæ¯æŠ•é€’è¯­ä¹‰ï¼š**
- **At Most Once**: æœ€å¤šä¸€æ¬¡ï¼Œå¯èƒ½ä¸¢å¤±
- **At Least Once**: è‡³å°‘ä¸€æ¬¡ï¼Œå¯èƒ½é‡å¤
- **Exactly Once**: ç²¾ç¡®ä¸€æ¬¡ï¼Œç†æƒ³çŠ¶æ€

### **é«˜çº§** é«˜å¯ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„
**é¢˜ç›®ï¼š** è®¾è®¡ä¸€ä¸ªæ”¯æŒåƒä¸‡çº§QPSçš„æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿï¼Œéœ€è¦è€ƒè™‘åˆ†åŒºã€å‰¯æœ¬ã€è´Ÿè½½å‡è¡¡ç­‰ã€‚

```mermaid
graph TB
    subgraph "ç”Ÿäº§è€…é›†ç¾¤"
        A1[Producer1] --> LB[è´Ÿè½½å‡è¡¡å™¨]
        A2[Producer2] --> LB
        A3[Producer3] --> LB
    end
    
    subgraph "Kafkaé›†ç¾¤"
        LB --> B1[Broker1<br/>Leader]
        LB --> B2[Broker2<br/>Follower]
        LB --> B3[Broker3<br/>Follower]
        
        B1 --> B2
        B1 --> B3
    end
    
    subgraph "æ¶ˆè´¹è€…é›†ç¾¤"
        B1 --> C1[Consumer1]
        B2 --> C2[Consumer2]
        B3 --> C3[Consumer3]
    end
    
    subgraph "ç›‘æ§ç³»ç»Ÿ"
        D[Zookeeper] --> B1
        D --> B2
        D --> B3
    end
```

## âš¡ ä¸»æµMQäº§å“å¯¹æ¯”

| ç‰¹æ€§ | RabbitMQ | Kafka | RocketMQ | Pulsar |
|------|----------|-------|----------|--------|
| æ€§èƒ½ | ä¸­ç­‰ | é«˜ | é«˜ | é«˜ |
| å¯é æ€§ | é«˜ | é«˜ | é«˜ | é«˜ |
| ç”Ÿæ€ | æˆç†Ÿ | ä¸°å¯Œ | é˜¿é‡Œç³» | æ–°å…´ |
| å­¦ä¹ æˆæœ¬ | ä½ | ä¸­ | ä¸­ | é«˜ |
| é€‚ç”¨åœºæ™¯ | ä¼ ç»Ÿä¼ä¸š | å¤§æ•°æ® | ç”µå•†äº¤æ˜“ | äº‘åŸç”Ÿ |

## ğŸ”§ å…³é”®æŠ€æœ¯å®ç°

### æ¶ˆæ¯åˆ†åŒºç­–ç•¥

```mermaid
flowchart TD
    A[åˆ†åŒºç­–ç•¥] --> B[è½®è¯¢åˆ†åŒº]
    A --> C[é”®å€¼å“ˆå¸Œ]
    A --> D[éšæœºåˆ†åŒº]
    A --> E[è‡ªå®šä¹‰åˆ†åŒº]
    
    B --> B1[è´Ÿè½½å‡è¡¡]
    C --> C1[ç›¸åŒé”®å€¼åŒåˆ†åŒº]
    D --> D1[å®Œå…¨éšæœº]
    E --> E1[ä¸šåŠ¡é€»è¾‘å®šåˆ¶]
```

### æ¶ˆè´¹è€…è´Ÿè½½å‡è¡¡

```mermaid
sequenceDiagram
    participant CG as Consumer Group
    participant C1 as Consumer1
    participant C2 as Consumer2
    participant B as Broker
    
    Note over CG: æ¶ˆè´¹è€…ç»„åè°ƒ
    C1->>B: åŠ å…¥æ¶ˆè´¹è€…ç»„
    C2->>B: åŠ å…¥æ¶ˆè´¹è€…ç»„
    B->>CG: è§¦å‘é‡å¹³è¡¡
    CG->>C1: åˆ†é…åˆ†åŒº0,1
    CG->>C2: åˆ†é…åˆ†åŒº2,3
    
    C1->>B: æ‹‰å–åˆ†åŒº0,1æ¶ˆæ¯
    C2->>B: æ‹‰å–åˆ†åŒº2,3æ¶ˆæ¯
```

## ğŸ”— ç›¸å…³é“¾æ¥

- [â† è¿”å›ç³»ç»Ÿè®¾è®¡ä¸»é¡µ](./README.md)
- [åˆ†å¸ƒå¼ç³»ç»Ÿ](./distributed-systems.md)
- [å¾®æœåŠ¡æ¶æ„](./microservices-architecture.md)

---

*æ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ„å»ºå¯æ‰©å±•åˆ†å¸ƒå¼ç³»ç»Ÿçš„å…³é”®ç»„ä»¶* ğŸ“¨ 